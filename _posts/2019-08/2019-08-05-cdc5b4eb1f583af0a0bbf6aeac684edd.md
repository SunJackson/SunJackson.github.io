---
layout:     post
catalog: true
title:      How to automate artistic taste (Basic clustering example with python and sklearn)
subtitle:      转载自：https://www.codementor.io/mathiasgatti/the-beauty-formula-identifying-interesting-patterns-automatically-based-on-aesthetic-metrics-basic-clustering-example-with-scikit-learn-xka5d6do8
date:      2019-08-05
author:      Mathias Gatti
tags:
    - clusterization
    - clustering
    - clusters
    - fractal
    - patterns
---

##  Introduction

Some time ago I created this small script to convert numbers into patterns. I'm not going to explain how the script works in detail but it's inspired on Stephen Wolfram's Elementary Cellular Automatas which converts numbers like 30 into binary (00011110) and then interprets the digits as turning ON or OFF of 8 different basic rules (In that case there are 4 rules activated, rule 4, 5, 6 and 7) that define when to turn ON and OFF a pixel in the image.

![](https://ucarecdn.com/a4323adb-4c13-4c4f-a32d-97f86468a1f0/)


Using this I can generate an infinite number of different patterns, the problem is that most of them are not really interesting and I have no time to check them one by one. That's why in this post I explain how I tried to automate the process of finding out the most interesting/beautiful cellular automatas.

##  Clusterization

My goal is to group the patterns by its beauty. I do this using a clustering algorithm based on features frequently attributed to beauty such as fractal dimensionality and compression efficiency. You can read more about these features here: Forsythe, Alex, et al. "Predicting beauty: fractal dimension and visual complexity in art.".

##  The Code

The full code is here but I also uploaded it into colab here so you can run everything from your web browser.

###  Defining clustering attributes

First I define the previously mentioned attributes, fractal dimension (Code taken from here) and compression score (The weight of a raw tiff image over its weight compressed as a gif image).

```
from fractaldimension import fractal_dimension
import cv2
import os

def fractalDimension(number):
 im = cv2.imread('images/'+str(number)+'.tiff', cv2.IMREAD_GRAYSCALE)
 newDimension = fractal_dimension(im, 0.9)
 return newDimension

def compressionScore(number):
 statinfo = os.stat('images/'+str(number)+'.gif')
 gif = statinfo.st_size # size of the file
 
 statinfo = os.stat('images/'+str(number)+'.tiff')
 tiff = statinfo.st_size # size of the file
 
 return tiff/gif

```

###  Clustering

There are several clustering algorithms, you can choose the one that best fits your use case.

![](https://ucarecdn.com/a6d86443-9072-44f0-b032-ccede2fe4073/)


In my case I ended up using Agglomerative Clustering which captures better the long and narrow clusters generated by this dataset.

You need to specify the number of clusters, I tried with different numbers, at the end I chose 5 since it grouped them well from null patterns to crazy and chaotic ones.

```
from sklearn.cluster import AgglomerativeClustering
import matplotlib.pyplot as plt
from matplotlib import cm

# Applying clustering algorithm
clustering = AgglomerativeClustering(n_clusters=5).fit(df[['Fractal Dimension','Compression Eficciency']].values)
df["cluster"] = clustering.labels_

# Plotting results
fig, ax = plt.subplots()
cmap = cm.get_cmap('gist_rainbow')
ax = df.plot(kind='scatter', x='Fractal Dimension', y='Compression Eficciency',cmap=cmap, c='cluster',ax=ax)
plt.show()

```

![](https://ucarecdn.com/4fe8f003-2d3f-4296-8c24-9283bb587e2b/)


##  Results

Here I show some samples of each cluster. I sorted them from the simplest ones to the most complex. As you can see this method is useful to identify and discard uninteresting patterns such us the ones from the Cluster 0. It's also useful to identify the most beautiful patterns, most of the best patterns I found are from the Cluster 3, the one with big complexity but not the biggest fractal dimension.

###  Cluster 0 (Null patterns)

![](https://ucarecdn.com/6f41e3ce-45dd-4b8e-aa00-b96fde1f09b4/)


###  Cluster 1

![](https://ucarecdn.com/565971db-1047-4100-92aa-c4feca3697ef/)


###  Cluster 2

![](https://ucarecdn.com/98775929-3cdc-4ff7-8dbb-0038663896bd/)


###  Cluster 3

![](https://ucarecdn.com/8f4a6dcf-b501-4b8a-bcc0-0b4822b6c26e/)


###  Cluster 4 (Crazy and chaotic patterns)

![](https://ucarecdn.com/b7066ecc-a054-4d34-9ec6-e9ef521fad85/)

