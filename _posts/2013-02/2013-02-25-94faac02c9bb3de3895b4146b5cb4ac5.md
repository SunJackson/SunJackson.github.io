---
layout:     post
title:      The Fun of Error Trapping： R Package Edition
subtitle:   转载自：http://randyzwitch.com/r-error-message-fun/
date:       2013-02-25
author:     未知
header-img: img/background0.jpg
catalog: true
tags:
    - errors
    - r package
    - json
    - functions
    - omniture
---

For the last month or so I’ve been working on an R package to make accessing the [Adobe (Omniture) Digital Marketing Suite Reporting API](https://developer.omniture.com/) easier.  As part of this development effort, I’m at the point where I’m intentionally introducing errors into my function inputs, trying to guess some of the ways users might incorrectly input arguments into each function.  Imagine my surprise when I saw this:

> 
> result <- content(json)Loading required package: XMLError in parser(content, …) : could not find function “htmlTreeParse”In addition: Warning message:In library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :there is no package called ‘XML’


The main idea behind the functions I’ve written is making REST calls to the Omniture API, which done correctly return valid [JSON](http://www.json.org/). From there, each JSON string is converted from binary or whatever formatting they come back as using the [`content`](http://cran.r-project.org/web/packages/httr/index.html) function from the [`httr`](http://cran.r-project.org/web/packages/httr/index.html) package. Without specifying any arguments to the `content` function, the function tries to guess at the proper translation method.

The guessing is all fine and good until you don’t pass a valid JSON string!  In this case, the error message is guessing that it might be XML (the returned error is actually HTML), tries to load the XML package…then says it can’t load the XML package. A two-for-one error!

Maybe it’s just me, but I’m finding this hilarious after a long day of programming. Maybe it’s because I’m not longer intimidated by an error like this, and as such, I’ve gotten over the steep learning curve of R.

*Note:  Hadley, if you read this, I’m not saying your httr package has any sort of bug or anything. Just that I found this particular error amusing.*
