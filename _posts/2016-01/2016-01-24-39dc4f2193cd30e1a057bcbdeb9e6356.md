---
layout:     post
title:      The Mathematics Behind： Rejection Sampling
subtitle:   转载自：https://www.data-blogger.com/2016/01/24/the-mathematics-behind-rejection-sampling/
date:       2016-01-24
author:     Kevin Jacobs
header-img: img/background2.jpg
catalog: true
tags:
    - samples
    - sampling
    - sampled
    - approximation
    - approximate
---

![](https://www.data-blogger.com/wp-content/uploads/2016/01/rs1-300x225.png)


Suppose that we have a probability density function (PDF) ![](https://s0.wp.com/latex.php?latex=f%28x%29&bg=ffffff&fg=000&s=0)
 that is impossible to analyze analytically. How can we ever draw samples from this PDF? Luckily, there are many techniques out there and this time I will highlight rejection sampling. A simple to implement (but not always effective) sampling method.

By the way, you should definitely read this article on [curve fitting in MATLAB](https://www.data-blogger.com/2016/01/20/the-mathematics-behind-polynomial-curve-fitting).



## The goal

Suppose we have a function that is not computationally tracktable. How can we ever draw samples from it? One (of the many) methods that is out there, is rejection sampling. In this article, we will try to draw samples from the following distribution:

![](https://www.data-blogger.com/wp-content/uploads/2016/01/rs4-300x225.png)


The secret function in this plot is ![](https://s0.wp.com/latex.php?latex=f%28x%29+%3D+%5Cfrac%7B3%7D%7B5%7D+%5Cmathcal%7BN%7D%28x%7C%5Cfrac%7B7%7D%7B20%7D%2C+%5Cfrac%7B1%7D%7B20%7D%29+%2B+%5Cfrac%7B2%7D%7B5%7D+%5Cmathcal%7BN%7D%28x%7C%5Cfrac%7B13%7D%7B20%7D%2C+%5Cfrac%7B2%7D%7B25%7D%29&bg=ffffff&fg=000&s=0)
, which is a multimodal Gaussian. (Note: this function is mathematically tractable, but it is used for demonstration purposes.)

## Approximation

Now we have to come up with a probability density function ![](https://s0.wp.com/latex.php?latex=g%28x%29&bg=ffffff&fg=000&s=0)
, such that ![](https://s0.wp.com/latex.php?latex=M+g%28x%29+%3E+f%28x%29&bg=ffffff&fg=000&s=0)
 for all ![](https://s0.wp.com/latex.php?latex=x&bg=ffffff&fg=000&s=0)
. In other words, we need a PDF that is, when multiplied by a constant ![](https://s0.wp.com/latex.php?latex=M&bg=ffffff&fg=000&s=0)
, higher than ![](https://s0.wp.com/latex.php?latex=f%28x%29&bg=ffffff&fg=000&s=0)
. On our example, one such a function is ![](https://s0.wp.com/latex.php?latex=g%28x%29%3D%5Cmathcal%7BN%7D%28x%7C%5Cfrac%7B9%7D%7B20%7D%2C+%5Cfrac%7B1%7D%7B5%7D%29&bg=ffffff&fg=000&s=0)
 and ![](https://s0.wp.com/latex.php?latex=M%3D3&bg=ffffff&fg=000&s=0)
. How did I found this function? First of all, Gaussians are easy to compute. Therefore, I choose a Gaussian which has its mean around the “middle” of ![](https://s0.wp.com/latex.php?latex=f%28x%29&bg=ffffff&fg=000&s=0)
. I then tuned its variance and the constant ![](https://s0.wp.com/latex.php?latex=M&bg=ffffff&fg=000&s=0)
 by just trying out some values. The result is the following ![](https://s0.wp.com/latex.php?latex=M+%5Ccdot+g%28x%29&bg=ffffff&fg=000&s=0)
, which is indeed always more than ![](https://s0.wp.com/latex.php?latex=f%28x%29&bg=ffffff&fg=000&s=0)
:

![](https://www.data-blogger.com/wp-content/uploads/2016/01/rs2-300x225.png)


 

## The mathematics

So, what to do next? We sample pairs of ![](https://s0.wp.com/latex.php?latex=%28x%2C+u%29&bg=ffffff&fg=000&s=0)
 where ![](https://s0.wp.com/latex.php?latex=x&bg=ffffff&fg=000&s=0)
 are samples from the approximation Gaussian and ![](https://s0.wp.com/latex.php?latex=u&bg=ffffff&fg=000&s=0)
 is sampled from a uniform probability distribution in the interval ![](https://s0.wp.com/latex.php?latex=%5B0%2C+1%5D&bg=ffffff&fg=000&s=0)
. Then we look if ![](https://s0.wp.com/latex.php?latex=u+%3C+%5Cfrac%7Bf%28x%29%7D%7BM+%5Ccdot+g%28x%29%7D&bg=ffffff&fg=000&s=0)
, since if that is the case, then ![](https://s0.wp.com/latex.php?latex=%28x%2C+u%29&bg=ffffff&fg=000&s=0)
 lives below the function we want to approximate! Note that this pair ![](https://s0.wp.com/latex.php?latex=%28x%2C+u%29&bg=ffffff&fg=000&s=0)
 is also a sample of the function we wished to approximate.

## Results

The theory is summarized in the following Python script:

The resulted samples are the following:

![](https://www.data-blogger.com/wp-content/uploads/2016/01/rs3-300x225.png)


These samples clearly lie below the function which we wished to sample from:

![](https://www.data-blogger.com/wp-content/uploads/2016/01/rs1-300x225.png)


So this method works. However, note that this method is not efficient. We throw away many points and therefore waste a large amount of time. A better method is for example Markov Chain Monte Carlo (MCMC). The rejection sampling method is efficient in easy probability density functions, but you will have many problems (read: you throw a way a lot of points) if you have functions with many peeks.

## Exercise

Try to draw samples from the following PDF:

![](https://s0.wp.com/latex.php?latex=f%28x%29+%3D+%5Cfrac%7B1%7D%7B5%7D+%5Cmathcal%7BN%7D%28x%7C%5Cfrac%7B5%7D%7B20%7D%2C+%5Cfrac%7B4%7D%7B20%7D%29+%2B+%5Cfrac%7B2%7D%7B5%7D+%5Cmathcal%7BN%7D%28x%7C%5Cfrac%7B19%7D%7B20%7D%2C+%5Cfrac%7B6%7D%7B25%7D%29+%2B+%5Cfrac%7B2%7D%7B5%7D+%5Cmathcal%7BN%7D%28x%7C%5Cfrac%7B24%7D%7B20%7D%2C+%5Cfrac%7B1%7D%7B25%7D%29&bg=ffffff&fg=000&s=0)
.

 
