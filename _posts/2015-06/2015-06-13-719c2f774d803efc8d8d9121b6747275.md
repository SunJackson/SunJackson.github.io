---
layout:     post
title:      Fast Lomb-Scargle Periodograms in Python
subtitle:   转载自：http://jakevdp.github.io/blog/2015/06/13/lomb-scargle-in-python/
date:       2015-06-13
author:     Jake VanderPlas
header-img: img/background3.jpg
catalog: true
tags:
    - sampling
    - data
    - limits
    - based
    - frequency
---

### Frequency limits[¶](http://jakevdp.github.io/blog/2015/06/13/lomb-scargle-in-python#Frequency-limits)

Next, we need to choose the upper and lower limits of the frequency grid. On the low end, $f=0$ is suitable, but causes some numerical problems – we'll go one step away and use $\delta f$ as our minimum frequency.
But on the high end, we need to make a choice: what's the highest frequency we'd trust our data to be sensitive to?
At this point, many people are tempted to mis-apply the Nyquist-Shannon sampling theorem, and choose some version of the Nyquist limit for the data (based on, say, the minimum or mean spacing between observations).
But this is entirely wrong! The Nyquist frequency is derived from special properties of regularly-sampled data, and does not apply – even approximately – to irregularly-sampled time-series.
In fact, as we saw above, irregularly-sampled data can be sensitive to much, much higher frequencies than even the minimum spacing between observations.
With this in mind, the upper limit for frequencies should be determined based on **what kind of signal you are looking for.**

Still, a common (if dubious) rule-of-thumb is that the high frequency is some multiple of what Press & Rybicki call the "average" Nyquist frequency,

$$
\hat{f}_{Ny} = \frac{N}{2T}
$$

This means that the "typical" number of frequencies you'll need is

$$
N_{freq} \sim O\left[\frac{\hat{f}_{Ny}}{\delta f}\right] \sim O\left[\frac{N/(2T)}{1/T}\right] \sim O[N]
$$

That is, the number of frequencies to search will scale with the number of data points!
